<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Video Review</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <h2>Video Review Table</h2>

    <button id="openModalBtn" class="add-button"><i class="fa fa-plus"></i> Add New Video</button>


    <form method="GET" action="{{ url_for('review') }}">
        <div class="filter-section">
            <div class="filter-item">
                <label for="subject">Subject:</label>
                <select name="subject" id="subject">
                    <option value="All">All</option>
                    {% for subject in subjects %}
                        <option value="{{ subject }}">{{ subject }}</option>
                    {% endfor %}
                </select>
            </div>
    
            <div class="filter-item">
                <label for="status">Status:</label>
                <select name="status" id="status">
                    <option value="All">All</option>
                    {% for status in statuses %}
                        <option value="{{ status }}">{{ status }}</option>
                    {% endfor %}
                </select>
            </div>
    
            <div class="filter-item">
                <button type="submit" class="filter-button">
                    <i class="fas fa-filter"></i> Filter
                </button>

    

            </div>
                      
            <a href="{{ url_for('review') }}" class="clear-button">
                <i class="fas fa-times"></i> Clear
            </a>
        </div>
    </form>
    

    <!-- Video Table -->
    <table class="video-table">
        <thead>
            <tr>
                <th>Subject</th>
                <th>Chapter</th>
                <th>Episode</th>
                <th>Date</th>
                <th>Status</th>
                <th>File</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for video in videos %}
            <tr class="{% if video.status == 'Pending' %}pending-row{% endif %}">
                <td>{{ video.subject }}</td>
                <td>{{ video.chapter }}</td>
                <td>{{ video.episode }}</td>
                <td>{{ video.date }}</td>
                <td>{{ video.status }}</td>
                <td>
                    {% if video.file_path %}
                        <a href="{{ url_for('download_file', filename=video.file_path | basename) }}" title="Download"><i class="fa fa-download"></i></a>
                    {% else %}
                        No File
                    {% endif %}
                </td>
                <td>
                    <a href="{{ url_for('edit_video', video_id=video.id) }}" title="Edit"><i class="fa fa-pen-to-square edit-icon"></i></a>
                    <a href="{{ url_for('delete_video', video_id=video.id) }}" title="Delete" onclick="return confirm('Are you sure you want to delete this video?');"><i class="fa fa-trash delete-icon"></i></a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Modal -->
    <div id="videoModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeModalBtn">&times;</span>
            <h3>Add New Video</h3>
            <form action="{{ url_for('add_video') }}" method="POST" enctype="multipart/form-data">
                <label>Subject:</label>
                <select name="subject" required>
                    <option value="Math">Math</option>
                    <option value="Physics">Physics</option>
                    <option value="Biology">Biology</option>
                    <option value="Chemistry">Chemistry</option>
                </select>

                <label>Chapter:</label>
                <input type="text" name="chapter" required>

                <label>Episode:</label>
                <input type="text" name="episode" required>

                <label>Date:</label>
                <input type="date" name="date" required>

                <label>Status:</label>
                <select name="status" required>
                    <option value="Pending">Pending</option>
                    <option value="Under Review">Under Review</option>
                    <option value="Approved">Approved</option>
                </select>

                <label>File Upload (Only if status is Pending):</label>
                <input type="file" name="file_upload">

                <button type="submit">Submit</button>
            </form>
        </div>
    </div>

    <script>
        const openModalBtn = document.getElementById('openModalBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const videoModal = document.getElementById('videoModal');

        openModalBtn.onclick = () => videoModal.style.display = "block";
        closeModalBtn.onclick = () => videoModal.style.display = "none";

        window.onclick = function (event) {
            if (event.target === videoModal) {
                videoModal.style.display = "none";
            }
        }
    </script>
</body>
</html>
